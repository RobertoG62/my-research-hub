<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deep Research Hub 4.0 | Ultimate Edition</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body { font-family: 'Rubik', sans-serif; background: #f0f4f8; }
        
        /* Glassmorphism Styles */
        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.07);
        }
        
        .gradient-header {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Animations */
        .animate-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .pulse-focus:focus { box-shadow: 0 0 0 4px rgba(14, 165, 233, 0.2); }
    </style>
</head>
<body class="text-slate-800 h-screen flex flex-col overflow-hidden">

    <div id="root" class="h-full flex flex-col"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- Icons ---
        const Icons = {
            Brain: () => <i className="fas fa-brain"></i>,
            Search: () => <i className="fas fa-search"></i>,
            Sparkles: () => <i className="fas fa-wand-magic-sparkles"></i>,
            Copy: () => <i className="far fa-copy"></i>,
            Check: () => <i className="fas fa-check"></i>,
            History: () => <i className="fas fa-history"></i>,
            Trash: () => <i className="fas fa-trash-alt"></i>,
            External: () => <i className="fas fa-external-link-alt"></i>,
            Back: () => <i className="fas fa-arrow-right"></i>,
            Send: () => <i className="fas fa-paper-plane"></i>
        };

        // --- Tool Links ---
        const AI_TOOLS = [
            { id: 'claude', name: 'Claude', url: 'https://claude.ai/new', color: 'hover:border-orange-500', icon: 'ğŸ¤–' },
            { id: 'gemini', name: 'Gemini', url: 'https://gemini.google.com/app', color: 'hover:border-blue-500', icon: 'ğŸ’' },
            { id: 'chatgpt', name: 'ChatGPT', url: 'https://chatgpt.com/', color: 'hover:border-green-500', icon: 'ğŸŒ€' },
            { id: 'perplexity', name: 'Perplexity', url: 'https://www.perplexity.ai/', color: 'hover:border-teal-500', icon: 'ğŸ”' },
            { id: 'notebooklm', name: 'NotebookLM', url: 'https://notebooklm.google.com/', color: 'hover:border-purple-500', icon: 'ğŸ““' },
            { id: 'grok', name: 'Grok', url: 'https://grok.com/', color: 'hover:border-gray-800', icon: 'ğŸš€' },
            { id: 'genspark', name: 'GenSpark', url: 'https://www.genspark.ai/', color: 'hover:border-yellow-500', icon: 'âš¡' }
        ];

        // --- Main App ---
        const App = () => {
            // State
            const [step, setStep] = useState(1);
            const [history, setHistory] = useState([]);
            const [isGenerating, setIsGenerating] = useState(false);
            const [generatedPrompt, setGeneratedPrompt] = useState('');
            const [copied, setCopied] = useState(false);

            // Form State
            const [formData, setFormData] = useState({
                topic: '',
                goal: 'learning',
                depth: 'comprehensive',
                context: '',
                sources: true,
                platform: 'general'
            });

            // Load History on Mount
            useEffect(() => {
                const saved = localStorage.getItem('deep_research_hub_v4');
                if (saved) setHistory(JSON.parse(saved));
            }, []);

            // Save History Logic
            const saveToHistory = (topic, prompt) => {
                const newItem = {
                    id: Date.now(),
                    topic,
                    prompt,
                    date: new Date().toLocaleDateString('he-IL')
                };
                const newHistory = [newItem, ...history].slice(0, 20); // Keep last 20
                setHistory(newHistory);
                localStorage.setItem('deep_research_hub_v4', JSON.stringify(newHistory));
            };

            // Prompt Generation Logic (From V1)
            const generatePrompt = () => {
                setIsGenerating(true);
                setTimeout(() => {
                    const prompt = constructPrompt(formData);
                    setGeneratedPrompt(prompt);
                    saveToHistory(formData.topic, prompt);
                    setIsGenerating(false);
                    setStep(3);
                }, 1000);
            };

            const constructPrompt = (data) => {
                let roleDefinition = `You are an expert Deep Research Analyst. Your task is to conduct a comprehensive, high-quality deep dive into the following topic.`;
                
                let goalDesc = "";
                switch(data.goal) {
                    case 'decision': goalDesc = "Goal: To facilitate informed decision-making based on data."; break;
                    case 'writing': goalDesc = "Goal: To create a knowledge base for a comprehensive article or professional report."; break;
                    case 'creative': goalDesc = "Goal: To gain inspiration and innovative ideas based on current trends."; break;
                    default: goalDesc = "Goal: To learn the topic in the best, most comprehensive way possible.";
                }

                let depthDesc = "";
                switch(data.depth) {
                    case 'academic': depthDesc = "Tone & Depth: Use professional terminology, focus on academic studies and empirical data."; break;
                    case 'expert': depthDesc = "Tone & Depth: Expert-level analysis, including subtle nuances and edge cases."; break;
                    default: depthDesc = "Tone & Depth: Comprehensive overview covering both basics and advanced aspects."; break;
                }

                return `
*** DEEP RESEARCH PROMPT ***

**Role:** ${roleDefinition}

**TOPIC:** "${data.topic}"

**CONTEXT:**
${goalDesc}
${data.context ? `Additional Context: ${data.context}` : ''}
${depthDesc}

**INSTRUCTIONS:**
1. **Credibility First:** Rely only on high-authority sources. Verify facts.
2. **Structure:** Provide an Executive Summary followed by a Deep Dive.
3. **Data:** Look for specific statistics, market trends, and significant shifts (2024-2025).
4. **Format:** The output MUST be in HEBREW (×¢×‘×¨×™×ª), organized with clear headings and bullet points.
5. **Tools:** ${data.platform === 'notebooklm' ? 'Optimize output for NotebookLM ingestion (clear structure, high density).' : 'Utilize your full search capabilities.'}

**EXECUTION:**
Start by outlining the key areas you will investigate. If any critical info is missing to start, ask me ONE clarifying question. Otherwise, proceed immediately to the research report.
`.trim();
            };

            // Handlers
            const handleInputChange = (field, value) => {
                setFormData(prev => ({ ...prev, [field]: value }));
            };

            const loadFromHistory = (item) => {
                setFormData(prev => ({ ...prev, topic: item.topic }));
                setGeneratedPrompt(item.prompt);
                setStep(3);
            };

            const clearHistory = () => {
                if(confirm("×œ××—×•×§ ××ª ×›×œ ×”×”×™×¡×˜×•×¨×™×”?")) {
                    setHistory([]);
                    localStorage.removeItem('deep_research_hub_v4');
                }
            };

            const copyToClipboard = () => {
                navigator.clipboard.writeText(generatedPrompt);
                setCopied(true);
                setTimeout(() => setCopied(false), 2000);
            };

            const openTool = (url) => window.open(url, '_blank');
            
            const openAllTools = () => {
                if(confirm("×¤×¢×•×œ×” ×–×• ×ª×¤×ª×— 7 ×œ×©×•× ×™×•×ª ×—×“×©×•×ª. ×œ×”××©×™×š?")) {
                    AI_TOOLS.forEach(tool => window.open(tool.url, '_blank'));
                }
            };

            // --- UI Components ---

            return (
                <div className="flex h-full flex-col">
                    {/* Header */}
                    <header className="gradient-header text-white p-4 shadow-lg z-20 shrink-0">
                        <div className="max-w-7xl mx-auto flex justify-between items-center">
                            <div className="flex items-center gap-3">
                                <div className="bg-sky-500/20 p-2 rounded-lg backdrop-blur-sm border border-sky-500/30">
                                    <Icons.Brain />
                                </div>
                                <div>
                                    <h1 className="text-xl font-bold tracking-wide">Deep Research Hub <span className="text-sky-400 text-sm font-normal">4.0 Ultimate</span></h1>
                                    <p className="text-slate-400 text-xs">×× ×•×¢ ××—×§×¨ ×¢×•××§ ××©×•×œ×‘ AI</p>
                                </div>
                            </div>
                            <div className="flex gap-3 text-sm items-center">
                                <span className="bg-slate-800 px-3 py-1 rounded-full border border-slate-700 text-xs text-slate-300">
                                    {history.length} ××—×§×¨×™× ×‘××¨×›×™×•×Ÿ
                                </span>
                            </div>
                        </div>
                    </header>

                    <div className="flex-1 flex overflow-hidden max-w-7xl mx-auto w-full">
                        
                        {/* Sidebar (History) */}
                        <aside className="w-80 glass-panel border-r border-slate-200 hidden md:flex flex-col z-10 m-4 rounded-2xl overflow-hidden">
                            <div className="p-4 border-b border-slate-100 flex justify-between items-center bg-white/50">
                                <h3 className="font-bold text-slate-700 flex items-center gap-2">
                                    <Icons.History /> ××—×§×¨×™× ××—×¨×•× ×™×
                                </h3>
                                <button onClick={clearHistory} className="text-slate-400 hover:text-red-500 transition" title="× ×§×” ×”×™×¡×˜×•×¨×™×”">
                                    <Icons.Trash />
                                </button>
                            </div>
                            <div className="flex-1 overflow-y-auto p-2 space-y-2">
                                {history.length === 0 ? (
                                    <div className="text-center text-slate-400 text-sm mt-10">×”×”×™×¡×˜×•×¨×™×” ×¨×™×§×”</div>
                                ) : (
                                    history.map(item => (
                                        <div key={item.id} onClick={() => loadFromHistory(item)} 
                                             className="p-3 rounded-xl bg-white border border-slate-100 shadow-sm cursor-pointer hover:border-sky-500 hover:shadow-md transition group">
                                            <div className="font-medium text-slate-800 text-sm truncate">{item.topic}</div>
                                            <div className="text-xs text-slate-400 mt-1 flex justify-between">
                                                <span>{item.date}</span>
                                                <span className="opacity-0 group-hover:opacity-100 text-sky-500"><Icons.Back /></span>
                                            </div>
                                        </div>
                                    ))
                                )}
                            </div>
                        </aside>

                        {/* Main Content Area */}
                        <main className="flex-1 overflow-y-auto p-4 md:p-6 scroll-smooth">
                            
                            {/* STEP 1: Topic */}
                            {step === 1 && (
                                <div className="animate-in max-w-2xl mx-auto mt-10">
                                    <div className="glass-panel rounded-2xl p-8 md:p-12 shadow-xl text-center">
                                        <div className="w-20 h-20 bg-sky-100 text-sky-600 rounded-full flex items-center justify-center mx-auto mb-6 text-3xl shadow-inner">
                                            <Icons.Search />
                                        </div>
                                        <h2 className="text-3xl font-bold text-slate-800 mb-2">××” ×ª×¨×¦×” ×œ×—×§×•×¨ ×”×™×•×?</h2>
                                        <p className="text-slate-500 mb-8 max-w-md mx-auto">
                                            ×”××¢×¨×›×ª ×ª×¢×–×•×¨ ×œ×š ×œ×™×¦×•×¨ ×¤×¨×•××¤×˜ ××“×•×™×§ ×•×ª×§×©×¨ ××•×ª×š ×œ×›×œ ×›×œ×™ ×”××—×§×¨ ×”××•×‘×™×œ×™×.
                                        </p>
                                        
                                        <div className="relative max-w-xl mx-auto">
                                            <input 
                                                type="text" 
                                                value={formData.topic}
                                                onChange={(e) => handleInputChange('topic', e.target.value)}
                                                onKeyDown={(e) => e.key === 'Enter' && formData.topic && setStep(2)}
                                                placeholder="× ×•×©× ×”××—×§×¨ ×©×œ×š..." 
                                                className="w-full p-4 pr-12 text-lg rounded-xl border-2 border-slate-200 focus:border-sky-500 focus:ring-4 focus:ring-sky-100 outline-none transition pulse-focus shadow-sm"
                                            />
                                            <button 
                                                onClick={() => formData.topic && setStep(2)}
                                                disabled={!formData.topic}
                                                className={`absolute left-2 top-2 bottom-2 px-6 rounded-lg font-bold transition-all flex items-center gap-2 ${formData.topic ? 'bg-sky-600 text-white hover:bg-sky-700 shadow-md' : 'bg-slate-100 text-slate-300'}`}
                                            >
                                                ×”××©×š <Icons.Back />
                                            </button>
                                        </div>

                                        <div className="mt-8 flex justify-center gap-3 text-sm text-slate-400">
                                            <span>× ×¡×”: ××—×©×•×‘ ×§×•×•× ×˜×™</span> â€¢ <span>××’××•×ª × ×“×œ"×Ÿ 2025</span> â€¢ <span>×”×™×¡×˜×•×¨×™×” ×©×œ ×”-AI</span>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* STEP 2: Refine */}
                            {step === 2 && (
                                <div className="animate-in max-w-3xl mx-auto">
                                    <div className="glass-panel rounded-2xl overflow-hidden shadow-xl">
                                        <div className="bg-slate-50 p-6 border-b border-slate-100 flex justify-between items-center">
                                            <div>
                                                <h3 className="text-xl font-bold text-slate-800 flex items-center gap-2">
                                                    <span className="text-sky-500"><Icons.Sparkles /></span> ×“×™×•×§ ×”××—×§×¨
                                                </h3>
                                                <p className="text-sm text-slate-500">×¢×‘×•×¨: {formData.topic}</p>
                                            </div>
                                            <button onClick={() => setStep(1)} className="text-sm text-slate-500 hover:text-sky-600">×—×–×¨×” ×œ×©×œ×‘ 1</button>
                                        </div>

                                        <div className="p-8 space-y-6">
                                            {/* Goal */}
                                            <div>
                                                <label className="block text-sm font-bold text-slate-700 mb-2">××˜×¨×ª ×”××—×§×¨</label>
                                                <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                                                    {[
                                                        {id: 'learning', label: '×œ××™×“×”', icon: 'ğŸ“š'},
                                                        {id: 'decision', label: '×”×—×œ×˜×”', icon: 'âš–ï¸'},
                                                        {id: 'writing', label: '×›×ª×™×‘×”', icon: 'âœï¸'},
                                                        {id: 'creative', label: '×”×©×¨××”', icon: 'ğŸ’¡'}
                                                    ].map(opt => (
                                                        <button
                                                            key={opt.id}
                                                            onClick={() => handleInputChange('goal', opt.id)}
                                                            className={`p-3 rounded-xl border text-center transition-all ${formData.goal === opt.id ? 'border-sky-500 bg-sky-50 text-sky-700 font-bold shadow-sm' : 'border-slate-200 hover:bg-slate-50 text-slate-600'}`}
                                                        >
                                                            <div className="text-xl mb-1">{opt.icon}</div>
                                                            <div className="text-sm">{opt.label}</div>
                                                        </button>
                                                    ))}
                                                </div>
                                            </div>

                                            {/* Depth & Context */}
                                            <div className="grid md:grid-cols-2 gap-6">
                                                <div>
                                                    <label className="block text-sm font-bold text-slate-700 mb-2">×¢×•××§ ×•×¡×’× ×•×Ÿ</label>
                                                    <select 
                                                        value={formData.depth}
                                                        onChange={(e) => handleInputChange('depth', e.target.value)}
                                                        className="w-full p-3 bg-white border border-slate-200 rounded-xl focus:border-sky-500 outline-none"
                                                    >
                                                        <option value="comprehensive">××§×™×£ ×•××§×¦×•×¢×™ (××•××œ×¥)</option>
                                                        <option value="basic">×‘×¡×™×¡×™ ×•×¤×©×•×˜ (ELI5)</option>
                                                        <option value="academic">××§×“××™ ×•××—×§×¨×™</option>
                                                        <option value="expert">×¨××ª ××•××—×” (× ×™×•×× ×¡×™×)</option>
                                                    </select>
                                                </div>
                                                <div>
                                                    <label className="block text-sm font-bold text-slate-700 mb-2">×”×§×©×¨ × ×•×¡×£ (××•×¤×¦×™×•× ×œ×™)</label>
                                                    <input 
                                                        type="text" 
                                                        value={formData.context}
                                                        onChange={(e) => handleInputChange('context', e.target.value)}
                                                        placeholder="×œ××©×œ: ×”×ª××§×“ ×‘×©×•×§ ×”×™×©×¨××œ×™..."
                                                        className="w-full p-3 bg-white border border-slate-200 rounded-xl focus:border-sky-500 outline-none"
                                                    />
                                                </div>
                                            </div>

                                            {/* Generate Button */}
                                            <button 
                                                onClick={generatePrompt}
                                                disabled={isGenerating}
                                                className="w-full mt-4 bg-slate-900 hover:bg-slate-800 text-white font-bold py-4 rounded-xl shadow-lg transition transform active:scale-[0.99] flex items-center justify-center gap-3 text-lg"
                                            >
                                                {isGenerating ? (
                                                    <><i className="fas fa-circle-notch fa-spin"></i> ××¢×‘×“ × ×ª×•× ×™×...</>
                                                ) : (
                                                    <><Icons.Brain /> ×¦×•×¨ ×¤×¨×•××¤×˜ ×—×›×</>
                                                )}
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* STEP 3: Results & Tools */}
                            {step === 3 && (
                                <div className="animate-in max-w-5xl mx-auto space-y-6">
                                    
                                    {/* The Prompt */}
                                    <div className="glass-panel rounded-2xl overflow-hidden shadow-xl flex flex-col md:flex-row h-[500px]">
                                        <div className="flex-1 flex flex-col relative">
                                            <div className="bg-emerald-50 p-4 border-b border-emerald-100 flex justify-between items-center">
                                                <h3 className="font-bold text-emerald-800 flex items-center gap-2">
                                                    <span className="bg-emerald-200 p-1 rounded-md"><Icons.Check /></span> ×”×¤×¨×•××¤×˜ ××•×›×Ÿ
                                                </h3>
                                                <button onClick={() => {setStep(1); setFormData({...formData, topic: ''});}} className="text-xs font-bold text-emerald-700 hover:underline">
                                                    ××—×§×¨ ×—×“×©
                                                </button>
                                            </div>
                                            <textarea 
                                                value={generatedPrompt}
                                                readOnly
                                                className="flex-1 w-full p-6 text-slate-700 font-mono text-sm leading-relaxed outline-none resize-none bg-white/50 dir-ltr"
                                            ></textarea>
                                            <div className="p-4 bg-white border-t border-slate-100 flex justify-end">
                                                <button 
                                                    onClick={copyToClipboard}
                                                    className={`px-6 py-2 rounded-lg font-bold flex items-center gap-2 transition ${copied ? 'bg-emerald-500 text-white' : 'bg-slate-800 text-white hover:bg-slate-700'}`}
                                                >
                                                    {copied ? <Icons.Check /> : <Icons.Copy />}
                                                    {copied ? '×”×•×¢×ª×§!' : '×”×¢×ª×§ ×œ×œ×•×—'}
                                                </button>
                                            </div>
                                        </div>
                                    </div>

                                    {/* The Tools Deck */}
                                    <div className="glass-panel rounded-2xl p-6 md:p-8 shadow-lg">
                                        <div className="flex justify-between items-center mb-6">
                                            <h3 className="text-xl font-bold text-slate-800 flex items-center gap-2">
                                                <Icons.External /> ×‘×—×¨ ×›×œ×™ ×œ××—×§×¨
                                            </h3>
                                            <button onClick={openAllTools} className="text-sm font-bold text-sky-600 hover:bg-sky-50 px-3 py-1 rounded-lg border border-sky-100 transition">
                                                ×¤×ª×— ××ª ×›×•×œ× ×‘××§×‘×™×œ ğŸš€
                                            </button>
                                        </div>

                                        <div className="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-3">
                                            {AI_TOOLS.map(tool => (
                                                <button 
                                                    key={tool.id}
                                                    onClick={() => openTool(tool.url)}
                                                    className={`flex flex-col items-center justify-center p-4 bg-white border border-slate-200 rounded-xl shadow-sm hover:shadow-md transition-all group ${tool.color} hover:border-t-4`}
                                                >
                                                    <div className="text-2xl mb-2 grayscale group-hover:grayscale-0 transition duration-300">{tool.icon}</div>
                                                    <div className="font-bold text-slate-700 text-sm">{tool.name}</div>
                                                </button>
                                            ))}
                                        </div>
                                        
                                        <div className="mt-6 bg-slate-50 p-4 rounded-xl border border-slate-200 text-sm text-slate-600 flex items-start gap-3">
                                            <div className="text-sky-500 mt-1"><Icons.Sparkles /></div>
                                            <div>
                                                <strong>×˜×™×¤ ×œ××§×¦×•×¢× ×™×:</strong> ×¢×‘×•×¨ ××—×§×¨ ××¡××›×™×, ×”×©×ª××© ×‘-<strong>NotebookLM</strong>. ×¢×‘×•×¨ ××™×“×¢ ×‘×–××Ÿ ×××ª, ×”×©×ª××© ×‘-<strong>Perplexity</strong> ××• <strong>Gemini</strong>. ×¢×‘×•×¨ ×›×ª×™×‘×” ×•×™×¦×™×¨×ª×™×•×ª, <strong>Claude</strong> ×”×•× ×”××•××œ×¥.
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            )}

                        </main>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
